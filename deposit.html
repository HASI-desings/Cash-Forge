<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Deposit - CashForge</title>

    <!-- Project Core Styles -->
    <link rel="stylesheet" href="css/core.css">
    <!-- Page Specific Styles -->
    <link rel="stylesheet" href="css/deposit.css">

    <script src="https://unpkg.com/lucide@latest"></script>
    
    <!-- Router for protection (Executes immediately) -->
    <script type="module" src="js/utils/router.js"></script>
    
    <!-- PAGE SCRIPT MOVED TO HEAD: Ensures NetworkUI is globally available before DOM interaction -->
    <script type="module" src="js/controllers/deposit.js"></script>
</head>
<body class="app-body">

    <header class="app-header">
        <button class="icon-btn" onclick="window.history.back()">
            <i data-lucide="arrow-left"></i>
        </button>
        <div class="header-title">Deposit USDT</div>
        <!-- Balance Placeholder: Initial state set to PKR 0.00 -->
        <div style="background: rgba(255,255,255,0.5); padding: 5px 10px; border-radius: 20px; font-size: 0.8rem;">
            Bal: <span id="avail-balance">PKR 0.00</span>
        </div> 
    </header>

    <main class="app-content" style="padding-top: 0;">
        <div class="deposit-container">

            <label style="font-size: 12px; font-weight: bold; color: #444; margin-bottom: 10px; display: block;">SELECT NETWORK</label>
            <div class="network-tabs">
                <div class="net-tab active" onclick="NetworkUI.switch('TRC20')">TRC-20</div>
                <div class="net-tab" onclick="NetworkUI.switch('BSC')">BEP-20 (BSC)</div>
            </div>

            <div class="calc-card">
                <div style="text-align: center; margin-bottom: 20px;">
                    <h3 style="margin-bottom: 5px;">Payment Address</h3>
                    <div style="font-size: 12px; color: #666; margin-bottom: 10px;">Send USDT (TRC-20 or BEP-20) to this address:</div>
                    
                    <div id="wallet-address" class="address-box">TAjyw8fVP8dkXJjqFE3vNMBWGaNz5sRbeG</div>
                    
                    <button class="copy-btn" onclick="NetworkUI.copyAddress()">
                        <i data-lucide="copy" style="width: 12px;"></i> <span id="copy-btn-text">Copy Address</span>
                    </button>
                </div>
            </div>

            <form onsubmit="event.preventDefault(); submitDeposit()">
                <div class="calc-card">
                    <!-- NEW INPUT: PKR (User Enters) -->
                    <div class="input-row">
                        <label>PAYMENT AMOUNT (PKR)</label>
                        <input type="number" id="pkr-amount-input" class="calc-input" placeholder="Min 2900 PKR" oninput="NetworkUI.calculateRate()" required>
                    </div>
                    
                    <div class="conversion-rate">Rate: 1 USDT = 290 PKR (Fixed)</div>

                    <!-- NEW OUTPUT: USDT (Calculated) -->
                    <div class="input-row">
                        <label>ESTIMATED USDT (To be Credited)</label>
                        <input type="text" id="usdt-amount-output" class="calc-input" placeholder="0.00 USDT" readonly style="background: #f9f9f9;">
                    </div>

                    <label style="font-size: 11px; font-weight: bold; color: #888; margin-bottom: 5px; display: block;">PAYMENT PROOF (Required)</label>
                    <div class="upload-area" onclick="document.getElementById('file-upload').click()">
                        <i data-lucide="upload-cloud" style="margin-bottom: 5px;"></i><br>
                        Tap to upload screenshot
                    </div>
                    <input type="file" id="file-upload" style="display: none;" accept="image/*" onchange="NetworkUI.handleFileSelect(this)" required>
                    <div id="file-name" style="font-size: 11px; color: green; text-align: center; margin-bottom: 15px;"></div>

                    <button class="btn-primary" id="btn-deposit-submit" style="width: 100%;">
                        Confirm Payment
                    </button>
                </div>
            </form>

            <div style="text-align: center; font-size: 11px; color: #999; margin-bottom: 20px;">
                Note: Deposits usually arrive within 5-30 minutes after network confirmation.
            </div>

        </div>
    </main>

    <!-- Remaining scripts -->
    <script>
        window.onload = lucide.createIcons;
    </script>
</body>
</html>
