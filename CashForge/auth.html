<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>CashForge | Secure Access</title>
    
    <!-- FONTS -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Space+Grotesk:wght@500;700;800&display=swap" rel="stylesheet">
    
    <!-- GLOBAL STYLES -->
    <link rel="stylesheet" href="assets/css/style.css">
    
    <!-- ICONS -->
    <script src="https://unpkg.com/@phosphor-icons/web"></script>
    
    <!-- TAILWIND -->
    <script src="https://cdn.tailwindcss.com"></script>

    <style>
        /* Auth-Specific Styles */
        body {
            display: flex; align-items: center; justify-content: center;
            overflow: hidden; /* Prevent scroll on auth page */
        }

        .glass-card {
            background: var(--glass-bg);
            backdrop-filter: blur(24px); -webkit-backdrop-filter: blur(24px);
            border: 1px solid var(--glass-border);
            box-shadow: 0 20px 40px -5px rgba(0,0,0,0.1);
            width: 100%; max-width: 400px;
            border-radius: 32px; padding: 32px;
            position: relative; overflow: hidden;
            transition: height 0.4s var(--ease-smooth);
        }

        /* Input Group Positioning */
        .input-group { position: relative; margin-bottom: 16px; transition: all 0.2s; }
        .input-icon {
            position: absolute; left: 16px; top: 50%; transform: translateY(-50%);
            color: #94a3b8; font-size: 20px; transition: color 0.2s;
        }
        
        /* Adjust input padding to make room for icon */
        .input-glass { padding-left: 48px; }
        .input-glass:focus + .input-icon { color: #008b8b; }
        
        .toggle-password {
            position: absolute; right: 16px; top: 50%; transform: translateY(-50%);
            color: #94a3b8; cursor: pointer; padding: 4px;
        }

        /* Liquid Form Slider */
        .form-slider {
            display: flex; width: 200%; transition: transform 0.5s var(--ease-smooth);
        }
        .form-view { width: 50%; padding: 4px; opacity: 1; transition: opacity 0.3s ease; }
        .form-view.inactive { opacity: 0; pointer-events: none; }

        /* Password Strength Dots */
        .strength-dot { width: 8px; height: 8px; border-radius: 50%; background: #cbd5e1; transition: background 0.3s; }
        .strength-dot.active { background: #00FFFF; box-shadow: 0 0 10px #00FFFF; }
        
        /* Loader inside button */
        .btn-loading { pointer-events: none; opacity: 0.8; }
        .btn-loader {
            width: 20px; height: 20px; border: 3px solid rgba(255,255,255,0.3);
            border-top-color: white; border-radius: 50%; animation: spin 0.8s linear infinite;
        }
    </style>
</head>
<body>

    <div class="bg-dots"></div>
    <!-- Floating Orbs -->
    <div class="blob blob-1" style="top: -10%; left: -10%;"></div>
    <div class="blob blob-2" style="bottom: -10%; right: -10%;"></div>

    <!-- MAIN CARD -->
    <main class="glass-card" id="main-card">
        
        <!-- LOGO HEADER -->
        <div class="text-center mb-6">
            <div class="relative h-24 w-full mx-auto mb-4 flex items-center justify-center">
                <!-- Glow -->
                <div class="absolute w-20 h-20 bg-cyan-400/30 blur-2xl rounded-full animate-pulse-glow"></div>
                
                <!-- LOGO IMAGE -->
                <img src="assets/images/logo.png" 
                     alt="CashForge" 
                     class="h-full w-auto object-contain relative z-10 drop-shadow-xl transform hover:scale-105 transition-transform duration-500"
                     onerror="this.style.display='none'; this.parentElement.innerHTML += '<div class=\'w-full h-full flex items-center justify-center bg-cyan-100 rounded-2xl text-cyan-800 font-bold text-3xl\'>CF</div>'">
            </div>
            
            <h1 class="heading-font text-2xl font-bold text-slate-800" id="auth-title">Welcome Back</h1>
            <p class="text-sm text-slate-500 mt-1" id="auth-subtitle">Secure access to your portfolio</p>
        </div>

        <!-- Sliding Container -->
        <div class="overflow-hidden">
            <div class="form-slider" id="slider">
                
                <!-- LOGIN FORM -->
                <div class="form-view" id="login-view">
                    <form onsubmit="handleLogin(event)">
                        <div class="input-group">
                            <input type="email" id="login-email" class="input-glass" placeholder="Email Address" required>
                            <i class="ph-bold ph-envelope-simple input-icon"></i>
                        </div>
                        <div class="input-group">
                            <input type="password" id="login-pass" class="input-glass" placeholder="Password" required>
                            <i class="ph-bold ph-lock-key input-icon"></i>
                            <i class="ph-bold ph-eye toggle-password" onclick="togglePass('login-pass', this)"></i>
                        </div>
                        
                        <div class="flex justify-end mb-6">
                            <a href="#" class="text-xs font-bold text-cyan-600 hover:text-cyan-700">Forgot Password?</a>
                        </div>

                        <button type="submit" class="btn-primary" id="login-btn">
                            <span>Sign In</span> <i class="ph-bold ph-arrow-right"></i>
                        </button>
                    </form>

                    <div class="text-center mt-6">
                        <p class="text-sm text-slate-500">Don't have an account? <button onclick="switchMode('register')" class="text-cyan-600 font-bold hover:underline">Create one</button></p>
                    </div>
                </div>

                <!-- REGISTER FORM -->
                <div class="form-view inactive" id="register-view">
                    <form onsubmit="handleRegister(event)">
                        <div class="input-group">
                            <input type="text" id="reg-name" class="input-glass" placeholder="Full Name" required>
                            <i class="ph-bold ph-user input-icon"></i>
                        </div>
                        <div class="input-group">
                            <input type="email" id="reg-email" class="input-glass" placeholder="Email Address" required>
                            <i class="ph-bold ph-envelope-simple input-icon"></i>
                        </div>
                        <div class="input-group mb-2">
                            <input type="password" id="reg-pass" class="input-glass" placeholder="Create Password" required oninput="checkStrength(this.value)">
                            <i class="ph-bold ph-lock-key input-icon"></i>
                            <i class="ph-bold ph-eye toggle-password" onclick="togglePass('reg-pass', this)"></i>
                        </div>
                        
                        <!-- Strength Indicators -->
                        <div class="flex gap-1 mb-6 pl-2">
                            <div class="strength-dot" id="dot-1"></div>
                            <div class="strength-dot" id="dot-2"></div>
                            <div class="strength-dot" id="dot-3"></div>
                            <span class="text-[10px] text-slate-400 ml-2" id="strength-text">Min 8 chars</span>
                        </div>

                        <button type="submit" class="btn-primary" id="reg-btn">
                            <span>Create Account</span> <i class="ph-bold ph-user-plus"></i>
                        </button>
                    </form>

                    <div class="text-center mt-6">
                        <p class="text-sm text-slate-500">Already have an account? <button onclick="switchMode('login')" class="text-cyan-600 font-bold hover:underline">Sign In</button></p>
                    </div>
                </div>

            </div>
        </div>

    </main>

    <!-- TOAST NOTIFICATION -->
    <div id="toast" class="toast">
        <i class="ph-fill ph-check-circle text-lg"></i>
        <span id="toast-msg">Success</span>
    </div>

    <!-- LOGIC SCRIPT -->
    <script>
        // --- 1. UI LOGIC ---
        function switchMode(mode) {
            const slider = document.getElementById('slider');
            const loginView = document.getElementById('login-view');
            const regView = document.getElementById('register-view');
            const title = document.getElementById('auth-title');
            const subtitle = document.getElementById('auth-subtitle');

            if (mode === 'register') {
                slider.style.transform = 'translateX(-50%)';
                loginView.classList.add('inactive');
                regView.classList.remove('inactive');
                title.innerText = "Join CashForge";
                subtitle.innerText = "Start your financial journey";
            } else {
                slider.style.transform = 'translateX(0)';
                loginView.classList.remove('inactive');
                regView.classList.add('inactive');
                title.innerText = "Welcome Back";
                subtitle.innerText = "Secure access to your portfolio";
            }
        }

        function togglePass(id, icon) {
            const input = document.getElementById(id);
            if (input.type === "password") {
                input.type = "text";
                icon.classList.replace('ph-eye', 'ph-eye-slash');
            } else {
                input.type = "password";
                icon.classList.replace('ph-eye-slash', 'ph-eye');
            }
        }

        // --- 2. VALIDATION LOGIC ---
        function checkStrength(pass) {
            const dot1 = document.getElementById('dot-1');
            const dot2 = document.getElementById('dot-2');
            const dot3 = document.getElementById('dot-3');
            const text = document.getElementById('strength-text');

            let score = 0;
            if (pass.length >= 8) score++;
            if (/\d/.test(pass)) score++;
            if (/[!@#$%^&*]/.test(pass)) score++;

            // Reset Classes
            [dot1, dot2, dot3].forEach(d => {
                d.className = 'strength-dot'; // Remove active/colors
            });
            
            if (score >= 1) { 
                dot1.classList.add('active', 'bg-red-400'); 
                text.innerText = "Weak"; 
            }
            if (score >= 2) { 
                dot2.classList.add('active', 'bg-yellow-400'); 
                dot1.className = 'strength-dot active bg-yellow-400'; // Update prev dot
                text.innerText = "Good"; 
            }
            if (score === 3) { 
                dot3.classList.add('active', 'bg-green-400'); 
                dot1.className = 'strength-dot active bg-green-400';
                dot2.className = 'strength-dot active bg-green-400';
                text.innerText = "Strong"; 
            }
        }

        // --- 3. MOCK AUTH HANDLERS (Will be connected to Supabase in JS files) ---
        function handleLogin(e) {
            e.preventDefault();
            const btn = document.getElementById('login-btn');
            const email = document.getElementById('login-email').value;
            
            startLoading(btn, "Authenticating...");

            // Simulate Network Request
            setTimeout(() => {
                if (email.includes('@gmail.com')) {
                    showToast("Login Successful!", "success");
                    // Mock session storage for index.html router check
                    localStorage.setItem('sb-zdpkmxexqeirqnuproge-auth-token', 'mock-token');
                    setTimeout(() => window.location.href = 'home.html', 1000);
                } else {
                    stopLoading(btn, "Sign In", "ph-arrow-right");
                    showToast("Invalid Email Domain", "error");
                    shakeCard();
                }
            }, 1500);
        }

        function handleRegister(e) {
            e.preventDefault();
            const btn = document.getElementById('reg-btn');
            const pass = document.getElementById('reg-pass').value;

            if (pass.length < 8) {
                showToast("Password too short", "error");
                shakeCard();
                return;
            }

            startLoading(btn, "Creating Account...");

            setTimeout(() => {
                showToast("Account Created!", "success");
                stopLoading(btn, "Create Account", "ph-user-plus");
                setTimeout(() => switchMode('login'), 1000);
            }, 1500);
        }

        // --- UTILS ---
        function startLoading(btn, text) {
            btn.classList.add('btn-loading');
            btn.innerHTML = `<div class="btn-loader"></div> <span>${text}</span>`;
        }

        function stopLoading(btn, text, icon) {
            btn.classList.remove('btn-loading');
            btn.innerHTML = `<span>${text}</span> <i class="ph-bold ${icon}"></i>`;
        }

        function showToast(msg, type) {
            const toast = document.getElementById('toast');
            const msgEl = document.getElementById('toast-msg');
            const icon = toast.querySelector('i');

            // Reset classes
            toast.className = 'toast'; 
            
            // Add specific classes
            toast.classList.add('active', type);
            msgEl.innerText = msg;
            
            // Icon
            icon.className = type === 'success' ? 'ph-fill ph-check-circle' : 'ph-fill ph-warning-circle';

            setTimeout(() => {
                toast.classList.remove('active');
            }, 3000);
        }

        function shakeCard() {
            const card = document.getElementById('main-card');
            card.classList.add('animate-shake');
            setTimeout(() => card.classList.remove('animate-shake'), 500);
        }
    </script>
</body>
</html>