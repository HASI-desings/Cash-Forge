<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Task Viewer | CashForge</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        slate: { 50: '#f8fafc', 100: '#f1f5f9', 200: '#e2e8f0', 300: '#cbd5e1', 400: '#94a3b8', 500: '#64748b', 600: '#475569', 700: '#334155', 800: '#1e293b', 900: '#0f172a' },
                        cyan: { 50: '#ecfeff', 100: '#cffafe', 400: '#22d3ee', 500: '#06b6d4', 600: '#0891b2' }
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        display: ['Poppins', 'sans-serif'],
                    },
                    animation: {
                        'scan': 'scan 3s linear infinite',
                        'pulse-slow': 'pulse 3s infinite',
                    },
                    keyframes: {
                        scan: {
                            '0%': { top: '0%' },
                            '50%': { top: '100%' },
                            '100%': { top: '0%' }
                        }
                    }
                }
            }
        }
    </script>

    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=Poppins:wght@500;600;700&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="assets/css/core.css">
    
    <style>
        /* Light Theme Background */
        body {
            background-color: #f0fdfa;
            background-image: radial-gradient(#cbd5e1 1px, transparent 1px);
            background-size: 24px 24px;
        }

        /* Ambient Glow */
        .ambient-strip {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 300px;
            background: linear-gradient(180deg, rgba(34, 211, 238, 0.1) 0%, rgba(34, 211, 238, 0.05) 100%);
            z-index: 0;
            pointer-events: none;
        }

        /* White Card */
        .white-card {
            background: #ffffff;
            border-radius: 24px;
            box-shadow: 0 10px 30px -10px rgba(0, 0, 0, 0.05);
            border: 1px solid #f1f5f9;
            overflow: hidden;
            position: relative;
        }

        /* Header */
        .app-header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(8px);
            border-bottom: 1px solid #e2e8f0;
        }

        /* Scanner Line */
        .scanner-line {
            position: absolute;
            left: 0;
            width: 100%;
            height: 2px;
            background: #22d3ee;
            box-shadow: 0 0 15px #22d3ee;
            opacity: 0.8;
            animation: scan 3s linear infinite;
            z-index: 10;
        }
    </style>
</head>
<body class="text-slate-800 font-sans h-screen flex flex-col relative overflow-hidden">

    <div class="ambient-strip"></div>

    <header class="app-header px-4 py-4 flex justify-between items-center z-20">
        <div class="flex items-center gap-2">
            <div class="w-2 h-2 rounded-full bg-red-500 animate-pulse" id="rec-dot"></div>
            <span class="text-xs font-bold text-slate-500 uppercase tracking-wider">Verifying...</span>
        </div>
        <div class="bg-cyan-50 px-3 py-1 rounded-full border border-cyan-100">
             <span class="text-sm font-mono font-bold text-cyan-600" id="timer-display">20s</span>
        </div>
    </header>

    <main class="flex-1 p-6 flex flex-col justify-center relative z-10">
        
        <div class="white-card w-full aspect-[4/5] flex flex-col items-center justify-center p-8">
            
            <div class="scanner-line"></div>

            <div class="text-center space-y-6 relative z-10">
                
                <div class="w-20 h-20 bg-cyan-50 rounded-full mx-auto flex items-center justify-center border border-cyan-100 shadow-sm">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10 text-cyan-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" /><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" /></svg>
                </div>

                <div>
                    <h2 class="text-xl font-display font-bold text-slate-800 mb-2">Viewing Content</h2>
                    <p class="text-xs text-slate-500 max-w-[220px] mx-auto leading-relaxed">
                        System is validating your attention. <br>
                        <span class="font-bold text-slate-700">Do not minimize or switch tabs.</span>
                    </p>
                </div>

                <div class="flex gap-2 justify-center pt-4">
                    <div class="w-2 h-2 bg-slate-200 rounded-full animate-bounce"></div>
                    <div class="w-2 h-2 bg-slate-200 rounded-full animate-bounce delay-100"></div>
                    <div class="w-2 h-2 bg-slate-200 rounded-full animate-bounce delay-200"></div>
                </div>
            </div>

            <div class="absolute inset-0 opacity-[0.03]" style="background-image: radial-gradient(#000 1px, transparent 1px); background-size: 16px 16px;"></div>
        </div>

        <div class="mt-8 text-center">
             <p class="text-[10px] text-slate-400 uppercase tracking-widest font-medium bg-white/60 inline-block px-3 py-1 rounded-full border border-slate-100 backdrop-blur-sm">
                ⚠️ Anti-Cheat Active
            </p>
        </div>

    </main>

    <div class="h-1.5 bg-slate-100 w-full fixed bottom-0 left-0 z-30">
        <div id="progress-bar" class="h-full bg-gradient-to-r from-cyan-400 to-cyan-600 transition-all duration-1000 ease-linear shadow-[0_0_10px_rgba(34,211,238,0.5)]" style="width: 0%"></div>
    </div>

    <div id="failModal" class="hidden fixed inset-0 z-[100] bg-slate-900/40 backdrop-blur-sm flex flex-col items-center justify-center p-6 text-center">
        <div class="bg-white rounded-3xl p-8 w-full max-w-sm shadow-2xl animate-[shake_0.5s_ease-in-out]">
            <div class="w-16 h-16 bg-red-50 rounded-full flex items-center justify-center mx-auto mb-4 border border-red-100">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-red-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>
            </div>
            <h2 class="text-2xl font-bold text-slate-800 mb-2">Task Failed</h2>
            <p class="text-slate-500 text-sm mb-6 leading-relaxed">
                Focus lost. You switched tabs or minimized the app during validation.
            </p>
            <button onclick="window.location.reload()" class="w-full bg-red-500 hover:bg-red-600 text-white font-bold py-3.5 rounded-xl shadow-lg shadow-red-200 transition-transform active:scale-95">
                Retry Task
            </button>
            <button onclick="window.location.href='tasks-dashboard.html'" class="mt-4 text-xs text-slate-400 hover:text-slate-600 font-bold tracking-wide uppercase">Cancel</button>
        </div>
    </div>

    <div id="successModal" class="hidden fixed inset-0 z-[100] bg-slate-900/40 backdrop-blur-sm flex flex-col items-center justify-center p-6 text-center">
        <div class="bg-white rounded-3xl p-8 w-full max-w-sm shadow-2xl">
            <div class="w-16 h-16 bg-green-50 rounded-full flex items-center justify-center mx-auto mb-4 border border-green-100">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-green-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" /></svg>
            </div>
            <h2 class="text-2xl font-bold text-slate-800 mb-2">Completed!</h2>
            <p class="text-slate-500 text-sm mb-6">
                Reward credited successfully.
            </p>
            <button onclick="window.location.href='tasks-dashboard.html'" class="w-full bg-gradient-to-r from-cyan-500 to-cyan-600 hover:to-cyan-700 text-white font-bold py-3.5 rounded-xl shadow-lg shadow-cyan-200 transition-transform active:scale-95">
                Continue
            </button>
        </div>
    </div>

    <script>
        const DURATION = 20; 
        let timeLeft = DURATION;
        let timerInterval;
        let isFailed = false;

        const timerDisplay = document.getElementById('timer-display');
        const progressBar = document.getElementById('progress-bar');
        const failModal = document.getElementById('failModal');
        const successModal = document.getElementById('successModal');
        const recDot = document.getElementById('rec-dot');

        function startTimer() {
            timerInterval = setInterval(() => {
                if (isFailed) return;

                timeLeft--;
                timerDisplay.innerText = timeLeft + "s";
                
                const percent = ((DURATION - timeLeft) / DURATION) * 100;
                progressBar.style.width = percent + "%";

                if (timeLeft <= 0) {
                    completeTask();
                }
            }, 1000);
        }

        // Anti-Cheat: Detect Tab Switch
        document.addEventListener("visibilitychange", () => {
            if (document.visibilityState === 'hidden') {
                failTask();
            }
        });

        function failTask() {
            if (timeLeft > 0 && !isFailed) {
                isFailed = true;
                clearInterval(timerInterval);
                
                // Haptic Feedback
                if(navigator.vibrate) navigator.vibrate([200, 100, 200]);
                
                failModal.classList.remove('hidden');
                recDot.classList.remove('bg-red-500', 'animate-pulse');
                recDot.classList.add('bg-slate-300');
            }
        }

        function completeTask() {
            clearInterval(timerInterval);
            if(navigator.vibrate) navigator.vibrate(50);
            successModal.classList.remove('hidden');
        }

        // Start after small delay
        setTimeout(startTimer, 1000);
    </script>
</body>
</html>