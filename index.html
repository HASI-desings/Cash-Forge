<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>CashForge | Initializing...</title>
    
    <!-- FONTS -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Space+Grotesk:wght@500;700;800&display=swap" rel="stylesheet">
    
    <!-- GLOBAL STYLES -->
    <link rel="stylesheet" href="assets/css/style.css">
    
    <!-- TAILWIND (Utility) -->
    <script src="https://cdn.tailwindcss.com"></script>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        brand: { DEFAULT: '#00FFFF', dim: '#00e6e6', dark: '#008b8b' },
                        slate: { 850: '#1e293b' }
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        heading: ['Space Grotesk', 'sans-serif'],
                    },
                    animation: {
                        'float': 'float 6s ease-in-out infinite',
                        'pulse-glow': 'pulseGlow 3s infinite',
                    },
                    keyframes: {
                        float: {
                            '0%, 100%': { transform: 'translateY(0)' },
                            '50%': { transform: 'translateY(-10px)' },
                        },
                        pulseGlow: {
                            '0%, 100%': { opacity: 0.3, transform: 'scale(1)' },
                            '50%': { opacity: 0.6, transform: 'scale(1.1)' },
                        }
                    }
                }
            }
        }
    </script>

    <style>
        /* Specific Splash Styles */
        body {
            background: linear-gradient(180deg, #FFFFFF 0%, #dcfcfc 40%, #00FFFF 50%, #dcfcfc 60%, #FFFFFF 100%);
            height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }

        .logo-container {
            position: relative;
            width: 120px;
            height: 120px;
            margin-bottom: 24px;
            animation: float 6s ease-in-out infinite;
        }

        .logo-glow {
            position: absolute;
            inset: 0;
            background: rgba(0, 255, 255, 0.4);
            filter: blur(40px);
            border-radius: 50%;
            animation: pulse-glow 3s infinite;
        }

        .loader-bar {
            width: 140px;
            height: 4px;
            background: rgba(30, 41, 59, 0.1);
            border-radius: 99px;
            overflow: hidden;
            margin-top: 16px;
            position: relative;
        }

        .loader-progress {
            position: absolute;
            left: 0;
            top: 0;
            height: 100%;
            width: 0%;
            background: #008b8b;
            border-radius: 99px;
            transition: width 0.1s linear;
        }
    </style>
</head>
<body>

    <!-- DECORATIVE BACKGROUND -->
    <div class="fixed inset-0 pointer-events-none">
        <div class="absolute inset-0 bg-[radial-gradient(#008b8b_1px,transparent_1px)] [background-size:24px_24px] opacity-[0.12]"></div>
    </div>

    <!-- MAIN SPLASH CONTENT -->
    <div class="flex flex-col items-center z-10 relative">
        
        <!-- Logo -->
        <div class="logo-container">
            <div class="logo-glow"></div>
            <!-- Points to assets/images/logo.png. Includes Fallback if image not found -->
            <img src="assets/images/logo.png" 
                 alt="CashForge" 
                 class="w-full h-full object-contain relative z-20 drop-shadow-2xl"
                 onerror="this.style.display='none'; this.parentElement.innerHTML += '<div class=\'w-full h-full flex items-center justify-center bg-cyan-100 rounded-2xl text-cyan-800 font-bold text-3xl shadow-lg\'>CF</div>'">
        </div>

        <!-- Typography -->
        <h1 class="heading-font text-3xl font-bold text-slate-800 tracking-tight">CashForge</h1>
        <p class="text-xs font-mono text-slate-500 mt-1 tracking-widest uppercase">Secure Simulation</p>

        <!-- Loader -->
        <div class="loader-bar">
            <div id="progress" class="loader-progress"></div>
        </div>
        <p id="status-text" class="text-[10px] text-slate-400 mt-2 font-medium">Initializing...</p>

    </div>

    <!-- ROUTING LOGIC -->
    <script>
        const Router = {
            init: async () => {
                const bar = document.getElementById('progress');
                const status = document.getElementById('status-text');

                // 1. Simulate Loading Assets (0% -> 50%)
                await Router.simulateLoad(bar, 0, 50, 800);
                status.innerText = "Checking Session...";

                // 2. Check Logic (Mock Session Check)
                const introSeen = localStorage.getItem('cashforge_intro_seen');
                const session = localStorage.getItem('sb-zdpkmxexqeirqnuproge-auth-token'); 

                // 3. Finish Loading (50% -> 100%)
                await Router.simulateLoad(bar, 50, 100, 500);

                // 4. Determine Destination
                let targetPage = 'home.html';
                
                if (!introSeen) {
                    targetPage = 'intro.html';
                } else if (!session) {
                    targetPage = 'auth.html';
                }

                // 5. Navigate
                Router.navigate(targetPage);
            },

            simulateLoad: (element, start, end, duration) => {
                return new Promise(resolve => {
                    let current = start;
                    const step = (end - start) / (duration / 20);
                    const timer = setInterval(() => {
                        current += step;
                        if (current >= end) {
                            current = end;
                            clearInterval(timer);
                            resolve();
                        }
                        element.style.width = current + '%';
                    }, 20);
                });
            },

            navigate: (path) => {
                const status = document.getElementById('status-text');
                
                // --- CRASH FIX ---
                // If running in a 'blob:' URL (Preview Mode), relative paths break.
                // We detect this and show a message instead of crashing.
                if (window.location.protocol === 'blob:' || window.location.href.includes('scf.usercontent') || window.location.href.includes('googleusercontent')) {
                    console.log(`[Router] Navigation Simulated: ${path}`);
                    status.innerHTML = `Navigating to: <strong class="text-brand-dark">${path}</strong><br><span class="text-[9px] text-slate-300">(Redirect disabled in Preview)</span>`;
                    return; 
                }

                // REAL NAVIGATION (For your local file system)
                try {
                    window.location.replace(path);
                } catch (e) {
                    console.error("Navigation failed:", e);
                    // Fallback to simple href assignment
                    window.location.href = path;
                }
            }
        };

        // Start App
        window.onload = Router.init;
    </script>
</body>
</html>